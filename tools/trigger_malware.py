import requests, time
base='http://127.0.0.1:5000'
print('Posting malware log...')
r=requests.post(base+'/api/logs', json={
    'source':'test-script',
    'ip':'192.0.2.55',
    'user':'attacker',
    'event_type':'malware',
    'message':'malware detected',
    'timestamp': int(time.time())
})
print('POST /api/logs ->', r.status_code, r.text)
print('\nFetching /api/alerts...')
r2=requests.get(base+'/api/alerts')
print('GET /api/alerts ->', r2.status_code)
try:
    alerts=r2.json()
    print('Alerts count:', len(alerts))
    if alerts:
        print('Most recent alert:', alerts[0])
except Exception as e:
    print('Error parsing alerts JSON:', e)
